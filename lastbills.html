<table class="table">
    <thead>
    <tr>
        <th>uniqueID</th>
        <th>model</th>
        <th>price</th>
        <th>actions</th>
    </tr>
    </thead>
    <tbody id="bills">

</table>


<script>
    $(function () {


        const Datastore = require('nedb')
        const content = $('#content');


        const db = new Datastore({ filename: 'data/savefile', autoload: true });
        db.find({}, function (err, docs) {
            Object.keys(docs).forEach(function(key) {
                $('#bills').append(`<tr><td>${docs[key]["uniqueID"]}</td><td>${docs[key]["price"]}</td><td><button class="printBtn" id="bill-${docs[key]["_id"]}">Print</button><button class="editBtn" id="bill-${docs[key]["_id"]}">Edit</button><button class="delBtn" id="bill-${docs[key]["_id"]}">Delete</button></td></tr>`)

            });
            addSelectors();

        });


        function addSelectors() {

            //print
            $(".printBtn").on('click', function () {
                const printID = $(this).attr('id').split('-');

                db.find({ _id: printID[1] }, function (err, docs) {

                    data = {
                        uniqueID : docs[0]['uniqueID'],
                        date : docs[0]['date'],
                        dueDate : docs[0]['dueDate'],
                        quantity : docs[0]['quantity'],
                        rate : docs[0]['rate'],
                        vat : docs[0]['vat'],
                        description : docs[0]['description']
                    };
                    content.load('./result.html', data);
                });
            });

            //edit bill
            $(".editBtn").on('click', function () {
                const printID = $(this).attr('id').split('-');

                db.find({ _id: printID[1] }, function (err, docs) {

                    data = {
                        uniqueID : docs[0]['uniqueID'],
                        date : docs[0]['date'],
                        dueDate : docs[0]['dueDate'],
                        quantity : docs[0]['quantity'],
                        rate : docs[0]['rate'],
                        vat : docs[0]['vat'],
                        description : docs[0]['description']
                    };
                    content.load('./newbill.html', data);
                });
            });

            //delete bill
            $(".delBtn").on('click', function () {
                const printID = $(this).attr('id').split('-');
                db.remove({ _id: printID[1] }, {}, function (err, numRemoved) {
                    content.load('lastbills.html');
                });
            })
        }
    })
</script>